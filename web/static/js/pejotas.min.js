/**
 * pejotas 4.0.0
 * @license ARV Klerix @ 2016 
 * @author: Jordi Aguilar <klerix.com>
 */
var $pjs=$pjs||{config:{server:"http://localhost:8080/"},version:"4.0.0",divs:{},controllers:[],views:{}};$pjs.director={render:function(e){$pjs.divs.main=$('<div class="pjs" />').appendTo(e),$pjs.director._drawMenu(),$pjs.director._drawBody(),$pjs.spinner._draw(),$pjs.director._initRouter()}},$pjs.render=function(e){$pjs.director.render(e)},$pjs.director.menuItems=[{name:"Inicio",icon:"fa-home",route:"/"},{name:"Listar Habilidades",icon:"fa-list",route:"/habilidades/lista"},{name:"Subir personaje",icon:"fa-cloud-upload",route:"personajes/subir"}],$pjs.director._drawMenu=function(){$pjs.divs["menu-container"]=$('<div class="pjs-menu-container" />').appendTo($pjs.divs.main),$pjs.divs.menu=$('<div class="pjs-menu" />').appendTo($pjs.divs["menu-container"]),$("<span>Pejotas <em>v"+$pjs.version+"</em></span>").appendTo($pjs.divs.menu);var e=$("<menu />").appendTo($pjs.divs.menu);$('<span id="pjs-menu-selector"></span>').appendTo(e);for(var s=0;s<$pjs.director.menuItems.length;s++){var o=$pjs.director.menuItems[s];$pjs.director._drawMenuItem(e,o)}},$pjs.director._drawMenuItem=function(e,s){var o='<a title="'+s.name+'"><i class="fa '+s.icon+'" aria-hidden="true"></i></a>';$(o).on("mouseout",function(e){$("#pjs-menu-selector").text("")}).on("mouseover",function(e){$("#pjs-menu-selector").text(this.title)}).on("click",function(e){$pjs.router.navigate(s.route)}).appendTo(e)},$pjs.director._drawBody=function(){$pjs.divs["body-container"]=$('<div class="pjs-body-container" />').appendTo($pjs.divs.main),$pjs.divs.body=$('<div class="pjs-body" />').appendTo($pjs.divs["body-container"])},$pjs.spinner={show:function(){$pjs.divs.loader.jqxLoader("open")},hide:function(){$pjs.divs.loader.jqxLoader("close")},_draw:function(){$pjs.divs.loader=$('<div id="jqxLoader" />').appendTo($pjs.divs.main),$pjs.divs.loader.jqxLoader({width:150,height:100,text:"Cargando..."})}},$pjs.ajax=function(e,s){var o=$.ajax({url:$pjs.config.server+e,dateType:"json"});o.done(function(e){s(e)}),o.fail(function(e,s,o){$pjs.notify("La conexi&oacute;n no se ha podido establecer.","error"),console.error("Ajax request failed",o),$pjs.spinner.hide()})},$pjs.notify=function(e,s){s=s||"error",$('<div style="margin: 0 auto"><div>'+e+"</div></div>").jqxNotification({opacity:.9,autoOpen:!0,appendContainer:".pjs-body",template:s}).on("close",function(){this.remove()})},$pjs.router=new Navigo,$pjs.director._initRouter=function(){$.each($pjs.controllers,function(e,s){$pjs.router.on(s).resolve()}),$pjs.router.on("*",function(){$pjs.divs.body.html("Route not found")}).resolve()},$pjs.controllers.push({"/habilidades/lista":function(e){$pjs.spinner.show(),$pjs.ajax("habilidades",function(e){$pjs.divs.body.empty(),$("<h2>Habilidades</h2>").appendTo($pjs.divs.body),$pjs.views.Habilidades.list(e).appendTo($pjs.divs.body),$pjs.spinner.hide()})}}),$pjs.controllers.push({"/":function(e){$pjs.spinner.show(),$pjs.ajax("eventos",function(e){$pjs.divs.body.empty(),$("<h2>Eventos</h2>").appendTo($pjs.divs.body),$pjs.views.Eventos.list(e).appendTo($pjs.divs.body),$pjs.spinner.hide()})}}),$pjs.controllers.push({"/personajes/subir":function(e){$pjs.divs.body.html("upload")}}),$pjs.views.Eventos={list:function(e){var s=$('<div class="pjs-wrapper" />').appendTo($pjs.divs.body);return $.each(e,function(e,o){$pjs.views.Eventos.view(o).appendTo(s)}),s},view:function(e){var s=$('<div class="pjs-box pjs-evento" />'),o="<h3>"+e.nombre+"</h3><p>"+e.descripcion+"</p>";return e.custom_logo?s.css("background","url("+e.custom_logo+") no-repeat"):s.html('<div style="padding: 5px">'+o+"</div>"),s.jqxTooltip({content:o,position:"mouse"}),s.on("click",function(){$pjs.router.navigate("/eventos/"+e.id+"/crearpj/")}),s}},$pjs.views.Habilidades={list:function(e){var s=$('<div class="pjs-wrapper" />').appendTo($pjs.divs.body);return $.each(e,function(e,o){$pjs.views.Habilidades.view(o).appendTo(s)}),s},view:function(e){e.className=$pjs.nameToClass(e.nombre);var s=$('<div class="pjs-box pjs-skill" />');$('<div style="float: right; color: darkgray;">'+e.tipo+"</div>").appendTo(s),$($pjs.views.Habilidades.icon(e)).appendTo(s);var o=e.resumen.length>55?e.resumen.substring(0,55)+"...":e.resumen;return $("<div><strong>"+e.nombre+"</strong><br /><span>"+o+"</span></div>").appendTo(s),s.jqxTooltip({content:$pjs.views.Habilidades.tooltip(e),position:"mouse"}),s},tooltip:function(e){return"<div>"+$pjs.views.Habilidades.icon(e)+"<strong>"+e.nombre+"</strong><br /><em>"+e.categoria+"</em><br /><b>Tipo:</b> "+e.tipo+"<br /><b>Letan&iacute;a:</b> <em>"+e.letania+"</em><br /><br /><span>"+e.resumen+"</span></div>"},icon:function(e){return'<div class="pjs-icon icon-'+e.className+'" style="background-image:url(../static/images/hab/'+e.className+'.gif)" />'}},function(e){e.fn.pejotas=function(e){$pjs.render(this)}}(jQuery),$pjs.debugLevel=2,$pjs.messageLevels={1:"e",2:"w",3:"n",4:"d",5:"v"},$pjs.plainConsole=!1,$pjs.report=function(e,s,o){if(console&&console.log){s=s||4,o=o||"darkcyan";var n=$pjs.messageLevels[s],i="[Youbora] "+n+": ";if("undefined"!=typeof $pjs.remoteLog&&$pjs.remoteLog.enabled===!0&&$pjs.remoteLog(i+e),$pjs.debugLevel>=s)if($pjs.plainConsole||document.documentMode)$pjs.plainReport(e,i);else{var r=console.log;1==s&&console.error?r=console.error:2==s&&console.warn?r=console.warn:s>=4&&console.debug&&(r=console.debug),i="%c"+i,e instanceof Array?(e.splice(0,0,i,"color: "+o),r.apply(console,e)):r.call(console,i,"color: "+o,e)}}},$pjs.plainReport=function(e,s){if(e instanceof Array)for(var o in e)$pjs.plainReport(o);else"string"==typeof e?console.log(s+e):(console.log(s+"<next line>"),console.log(e))},$pjs.error=function(){$pjs.report([].slice.call(arguments),1,"darkred")},$pjs.warn=function(){$pjs.report([].slice.call(arguments),2,"darkorange")},$pjs.notice=function(){$pjs.report([].slice.call(arguments),3,"darkcyan")},$pjs.noticeRequest=function(){$pjs.report([].slice.call(arguments),3,"darkgreen")},$pjs.debug=function(){$pjs.report([].slice.call(arguments),4,"indigo")},$pjs.verbose=function(){$pjs.report([].slice.call(arguments),5,"navy")};for(var defaultDiacriticsRemovalMap=[{base:"a",letters:"aⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐ"},{base:"e",letters:"eⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇɛǝ"},{base:"i",letters:"iⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"o",letters:"oⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿɔꝋꝍɵ"},{base:"u",letters:"uⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"n",letters:"nⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥ"},{base:"-",letters:" "},{base:"",letters:"!.¡´"}],diacriticsMap={},i=0;i<defaultDiacriticsRemovalMap.length;i++)for(var letters=defaultDiacriticsRemovalMap[i].letters,j=0;j<letters.length;j++)diacriticsMap[letters[j]]=defaultDiacriticsRemovalMap[i].base;$pjs.nameToClass=function(e){return e.toLowerCase().replace(/[^a-z0-9]/g,function(e){return"undefined"!=typeof diacriticsMap[e]?diacriticsMap[e]:e})};